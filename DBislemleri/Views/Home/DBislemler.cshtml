<section class="content">
    <div class="row">
        <div class="col-md-6">
            <div class="card card-primary">
                <div class="card-header">
                    <h3 class="card-title">General</h3>

                    <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                            <i class="fas fa-minus"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="form-group">
                        <label for="inputName">Project Name</label>
                        <input type="text" id="inputName" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="inputDescription">Project Description</label>
                        <textarea id="inputDescription" class="form-control" rows="4"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="inputStatus">Status</label>
                        <select id="inputStatus" class="form-control custom-select">
                            <option selected disabled>Select one</option>
                            <option value="1">İşlemde</option>
                            <option value="2">Tamamlandı</option>
                            <option value="0">İptal Edildi</option>
                        </select>
                    </div>
                    <button type="button" onclick="send()">  Gönder  </button>
                </div>
                <!-- /.card-body -->
            </div>
            <!-- /.card -->
        </div>

        
            <table id="ProjectTable" class="table table-responsive">
                <thead>
                    
                </thead>
                <tbody>
                 
                   
                </tbody>
            </table>
        </div>

    </div>
</section>

<script>

    function send () {

        var taskForm = {
            ProjectName: $('#inputName').val(),
            ProjectDescription: $('#inputDescription').val(),
            Status: $('#inputStatus').val(),


        };
        console.log(taskForm);
        $.ajax({
            url: '@Url.Action("DBislemler" , "Home")',
            type: "Post",
            data: { newTask: taskForm },
            success: function (data) {
                if (data.success) {
                    DataGet();
                    swal({
                        title: data.restext,
                        icon: "success",
                        button: "Kapat",
                    });
                } else {
                    swal({
                        title: data.restext,
                        icon: "error",
                        button: "Kapat",
                    });
                }
            }, error: function (data) {
                swal({
                    title: data.restext,
                    icon: "error",
                    button: "Kapat",
                });
            }
        });
    }
    $(document).ready(function () {
        //$('#myTable').DataTable();
        DataGet();
    });
    
    function DataGet () {

        $.ajax({
            url: '@Url.Action("DBislemlerGet" , "Home")',
            type: "Get",
            success: function (data) {
                console.log(data);
                $("#ProjectTable").DataTable({
                    "responsive": true, "lengthChange": false, "autoWidth": false,
                   
                    "bDestroy": true,
                    data: data.dataList,
                    columns: [
                       
                        { title: "Proje Adı", data: "projectName" },
                        { title: "Proje Detay", data: "projectDescription" },
                        { title: "Status", data: "status" },

                        { title: "İŞLEM", data: "id","render":function(data){
                                console.log(data);
                                return "<a href=\"#\" onclick=\"deleteA(\'" + data + "\')\" class=\"\">Sil</a>"; 
                        
                        }
                        
                        },
                       
                    ]


                });
            }, error: function () { }
        });

    }

    function deleteA(Sil) {

        $.ajax({
            url: '@Url.Action("DBislemlerDelete" , "Home")',
            type: "Post",
            data: { ID:Sil },
            success: function (data) {
                if (data.success) {
                   DataGet(); 
                    swal({
                        title: data.restext,
                        icon: "success",
                        button: "Kapat",
                    });
                } else {
                    swal({
                        title: data.restext,
                        icon: "error",
                        button: "Kapat",
                    });
                }
            }, error: function (data) {
                swal({
                    title: data.restext,
                    icon: "error",
                    button: "Kapat",
                });
            }
        });
    }



</script>